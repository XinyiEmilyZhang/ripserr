<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculating Persistent Homology with a Vietoris-Rips Complex • ripserr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calculating Persistent Homology with a Vietoris-Rips Complex">
<meta property="og:description" content="ripserr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ripserr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cubical.html">Calculating Persistent Homology with a Cubical Complex</a>
    </li>
    <li>
      <a href="../articles/vietoris-rips.html">Calculating Persistent Homology with a Vietoris-Rips Complex</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rrrlw/ripserr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculating Persistent Homology with a Vietoris-Rips Complex</h1>
                        <h4 class="author">Raoul R. Wadhwa, Matthew Piekenbrock, Jacob G. Scott</h4>
            
            <h4 class="date">2020-11-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rrrlw/ripserr/blob/master/vignettes/vietoris-rips.Rmd"><code>vignettes/vietoris-rips.Rmd</code></a></small>
      <div class="hidden name"><code>vietoris-rips.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://rrrlw.github.io/ripserr">ripserr</a></span>)
</pre></div>
<div id="sample-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#sample-dataset" class="anchor"></a>Sample dataset</h2>
<p>In this vignette, we will generate a point cloud using a sample of 2-dimensional points on the unit circle’s circumference; this will be stored in a variable named <code>circle_df</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># create reproducible dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">42</span>)
<span class="kw">angles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">25</span>, <span class="fl">0</span>, <span class="fl">2</span> <span class="op">*</span> <span class="kw">pi</span>)
<span class="kw">circle_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(x = <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span>(<span class="kw">angles</span>),
                        y = <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(<span class="kw">angles</span>))

<span class="co"># take a peek at first 6 rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">circle_df</span>)
<span class="co">#&gt;            x          y</span>
<span class="co">#&gt; 1  0.8601210 -0.5100900</span>
<span class="co">#&gt; 2  0.9228553 -0.3851468</span>
<span class="co">#&gt; 3 -0.2251251  0.9743299</span>
<span class="co">#&gt; 4  0.4842164 -0.8749483</span>
<span class="co">#&gt; 5 -0.6289353 -0.7774577</span>
<span class="co">#&gt; 6 -0.9928106 -0.1196957</span>
</pre></div>
<p>Above, each of the 100 rows represents a single point, with each of the 2 columns representing a Cartesian coordinate for a single dimension. Column <code>x</code> contains the x-coordinates of the 100 points and column <code>y</code> contains the respective y-coordinates. To confirm that the points in <code>circle_df</code> do lie on the circumference of a circle, we can quickly create a scatterplot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co"># scatterplot of circle2d</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">circle_df</span>, xlab = <span class="st">"x"</span>, ylab = <span class="st">"y"</span>, main = <span class="st">"2-d circle point cloud"</span>)
</pre></div>
<p><img src="vietoris-rips_files/figure-html/plot-circle-1.png" width="384"></p>
</div>
<div id="calculating-persistent-homology" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-persistent-homology" class="anchor"></a>Calculating persistent homology</h2>
<p>Given that the points in <code>circle_df</code> are uniformly distributed across the circumference of a circle without any error or noise, we expect a single prominent 1-cycle to be present in its persistent homology. The <a href="https://github.com/Ripser/ripser">Ripser</a> C++ library is wrapped by R using <a href="https://github.com/RcppCore/Rcpp">Rcpp</a>, and performs calculations on a Vietoris-Rips complex created with the input point cloud. These calculations result in a data frame that contains all the necessary information to characterize the persistence of homological features within <code>circle_df</code>, and can be performed with a single line of R code using ripserr.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># calculate persistent homology</span>
<span class="kw">circ_phom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vietoris_rips.html">vietoris_rips</a></span>(<span class="kw">circle_df</span>)

<span class="co"># print first 6 features (ordered by dimension and birth)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">circ_phom</span>)
<span class="co">#&gt;   dimension birth      death</span>
<span class="co">#&gt; 1         0     0 0.01509939</span>
<span class="co">#&gt; 2         0     0 0.01846671</span>
<span class="co">#&gt; 3         0     0 0.02540582</span>
<span class="co">#&gt; 4         0     0 0.02859409</span>
<span class="co">#&gt; 5         0     0 0.04180345</span>
<span class="co">#&gt; 6         0     0 0.06699952</span>

<span class="co"># print last 6 features (ordered by dimension and birth)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="kw">circ_phom</span>)
<span class="co">#&gt;    dimension    birth     death</span>
<span class="co">#&gt; 20         0 0.000000 0.4582335</span>
<span class="co">#&gt; 21         0 0.000000 0.5059727</span>
<span class="co">#&gt; 22         0 0.000000 0.5793416</span>
<span class="co">#&gt; 23         0 0.000000 0.5812266</span>
<span class="co">#&gt; 24         0 0.000000 0.7170409</span>
<span class="co">#&gt; 25         1 1.026735 1.7859821</span>
</pre></div>
<p>Each row in the homology matrix returned by the <code>vietoris_rips</code> function (variable named <code>circ_phom</code>) represents a single feature (cycle). The homology matrix has 3 columns in the following order:</p>
<ol style="list-style-type: decimal">
<li>
<strong>dimension:</strong> if 0, represents a 0-cycle; if 1, represents a 1-cycle; and so on.</li>
<li>
<strong>birth:</strong> the radius of the Vietoris-Rips complex at which this feature was first detected.</li>
<li>
<strong>death:</strong> the radius of the Vietoris-Rips complex at which this feature was last detected.</li>
</ol>
<p>Persistence of a feature is generally defined as the length of the interval of the radius within which the feature exists. This can be calculated as the numerical difference between the second (birth) and third (death) columns of the homology matrix. Confirmed in the output of the <code>head</code> and <code>tail</code> functions above, the homology matrix is ordered by dimension, with the birth column used to compare features of the same dimension. As expected for <code>circle_df</code>, the homology matrix contains a single prominent 1-cycle (last line of <code>tail</code>’s output). Although we suspect the feature to be a persistent 1-cycle, comparison with the other features in the homology matrix is required to confirm that it is sufficiently persistent. This task is done far more easily with an appropriate visualization (e.g. topological barcode or persistence diagram) than by eyeballing the contents of <code>circ_phom</code>. The <a href="https://CRAN.R-project.org/package=ggtda">ggtda</a> and <a href="https://CRAN.R-project.org/package=TDAstats">TDAstats</a> R packages could be useful to create such visualizations.</p>
</div>
<div id="dataset-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-formats" class="anchor"></a>Dataset formats</h2>
<p>Although we used a data frame to store the example point cloud, a matrix or dist object would work equally well. Let’s test this out by creating the matrix and dist equivalents of <code>circle_df</code> and checking if the resulting <code>vietoris_rips</code> outputs are equal using <code><a href="https://rdrr.io/r/base/all.equal.html">base::all.equal</a></code> to compare data frames.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># matrix format</span>
<span class="kw">circ_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw">circle_df</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">circ_mat</span>)
<span class="co">#&gt;               x          y</span>
<span class="co">#&gt; [1,]  0.8601210 -0.5100900</span>
<span class="co">#&gt; [2,]  0.9228553 -0.3851468</span>
<span class="co">#&gt; [3,] -0.2251251  0.9743299</span>
<span class="co">#&gt; [4,]  0.4842164 -0.8749483</span>
<span class="co">#&gt; [5,] -0.6289353 -0.7774577</span>
<span class="co">#&gt; [6,] -0.9928106 -0.1196957</span>

<span class="co"># dist object</span>
<span class="kw">circ_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="kw">circ_mat</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">circ_dist</span>)
<span class="co">#&gt; [1] 0.1398085 1.8388207 0.5238567 1.5128695 1.8936112 1.0621818</span>

<span class="co"># calculate persistent homology of each</span>
<span class="kw">mat_phom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vietoris_rips.html">vietoris_rips</a></span>(<span class="kw">circ_mat</span>)
<span class="kw">dist_phom</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/vietoris_rips.html">vietoris_rips</a></span>(<span class="kw">circ_dist</span>)

<span class="co"># compare equality</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span>(<span class="kw">circ_phom</span>, <span class="kw">mat_phom</span>)
<span class="co">#&gt; [1] TRUE</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span>(<span class="kw">circ_phom</span>, <span class="kw">dist_phom</span>)
<span class="co">#&gt; [1] TRUE</span>
</pre></div>
</div>
<div id="coefficients-in-various-prime-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#coefficients-in-various-prime-fields" class="anchor"></a>Coefficients in various prime fields</h2>
<p>Ripser can calculate persistent homology with coefficients in various prime fields (<span class="math inline">\(\mathbb{Z}/p\mathbb{Z}\)</span>). ripserr implements this functionality via the <code>p</code> parameter in <code>vietoris_rips</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># prime field Z/2Z (default)</span>
<span class="kw">circ_phom2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vietoris_rips.html">vietoris_rips</a></span>(<span class="kw">circle_df</span>)

<span class="co"># prime field Z/5Z</span>
<span class="kw">circ_phom5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vietoris_rips.html">vietoris_rips</a></span>(<span class="kw">circle_df</span>, p = <span class="fl">5L</span>)

<span class="co"># confirm equal outputs</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span>(<span class="kw">circ_phom2</span>, <span class="kw">circ_phom5</span>)
<span class="co">#&gt; [1] TRUE</span>
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Raoul Wadhwa, Matt Piekenbrock, Jacob Scott.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
